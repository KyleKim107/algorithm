{% tabs %}
{% tab title='CF_1535.md' %}

> Question

* let ğ‘“(ğ‘ ) be the number of possible winners of the tournament described by the string  ğ‘ 
* Given one integer ğ‘˜ (1â‰¤ğ‘˜â‰¤18), string with len 2ğ‘˜âˆ’1 initial state of string ğ‘  (?, 0, 1)
* For each query ğ‘ (1â‰¤ğ‘â‰¤2â‹…10^5)
  * for ğ‘ and a character ğ‘ (ğ‘ â‰¤ 2ğ‘˜âˆ’1; ğ‘ = ?, 0, or 1), describing ğ‘–-th query

```txt
Input:
3
0110?11
6
5 1
6 ?
7 ?
1 ?
5 ?
1 1

Output:
1
2
3
3
5
4
```

{% endtab %}
{% tab title='CF_1535.py' %}

```py
import sys
input = lambda : sys.stdin.readline().strip()
input()
S = list(input())
N = len(S)
dp = [0] * N

for i, s in enumerate(S):
  if i <= N // 2:
    dp[i] += 2 if s == '?' else 1
  else:
    d = N - i
    l, r = N - d * 2 - 1, N - d * 2
    dp[i] = dp[l] + dp[r] if S[i] == '?' else dp[r] if S[i] == '1' else dp[l]
for _ in range(int(input())):
  i, to = input().split()
  i = int(i) - 1
  S[i] = to
  while i < N:
    d = N - i
    l, r = N - d * 2 - 1, N - d * 2
    if i <= N // 2:
      dp[i] = 2 if S[i] == '?' else 1
    else:
      dp[i] = dp[l] + dp[r] if S[i] == '?' else dp[r] if S[i] == '1' else dp[l]
    d = (N - i) // 2
    i = N - d
  print(dp[-1])
```

{% endtab %}
{% endtabs %}
